@using Microsoft.AspNetCore.Http
@inject IHttpContextAccessor HttpContextAccessor

@{
    var user = HttpContextAccessor.HttpContext?.User;
    var avatarId = user?.FindFirst("AvatarId")?.Value;
    Guid avatarGuid;
    string avatarPath;
    if (Guid.TryParse(avatarId, out avatarGuid) && avatarGuid != Guid.Empty)
        avatarPath = $"~/avatars/{avatarGuid}.jpg";
    else
        avatarPath = "~/icon/default-avatar.jpg";
}

<nav class="nav">
    <a class="nav-logo" asp-controller="Home" asp-action="Index">
        UserPortal
    </a>
    @if (User.Identity?.IsAuthenticated == true)
    {
        <a class="nav-avatar" asp-controller="User" asp-action="Profile">
            <img src="@Url.Content(avatarPath)" alt="Profile" class="avatar-image" />
        </a>
    }
    else
    {
        <!-- Text link for desktop -->
        <a class="nav-logo" id="nav-login-text" asp-controller="Auth" asp-action="Login">
            Login
        </a>
        <!-- Icon link for small screens -->
        <a class="nav-logo" id="nav-login-icon" asp-controller="Auth" asp-action="Login">
            <img src="~/icon/login.png" alt="Login" />
        </a>
    }
</nav>